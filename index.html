<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poker Hand History to XML Converter</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        textarea {
            width: 100%;
            height: 200px;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
        }
        #output {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            white-space: pre-wrap; /* For maintaining XML format */
            font-family: monospace;
            font-size: 16px;
            background-color: #f4f4f4;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>Poker Hand History to XML Converter</h1>
    
    <label for="historyInput">Gib die Pokerhand-Historie ein:</label>
    <textarea id="historyInput" placeholder="FÃ¼ge hier deine Pokerhand-Historie ein..."></textarea>
    
    <button onclick="convertToXML()">Konvertieren</button>

    <h2>Ausgabe als XML:</h2>
    <div id="output"></div>

    <script>
        function convertToXML() {
            const inputText = document.getElementById('historyInput').value;

            // Beispiel-Daten aus der Pokerhand-Historie extrahieren
            const handData = extractHandData(inputText);

            // Generiere XML
            const xml = generateXML(handData);
            document.getElementById('output').textContent = xml;
        }

        function extractHandData(handHistory) {
    if (!handHistory || typeof handHistory !== 'string') {
        console.error("Invalid hand history input");
        return {};
    }

    // Log the input to check what you're working with
    console.log("Hand History Input: ", handHistory);

    const lines = handHistory.split('\n');

    let handData = {};
    let currentSection = null;

    lines.forEach(line => {
        // Trim the line to remove unnecessary spaces
        const trimmedLine = line.trim();

        if (trimmedLine.startsWith("Hand #")) {
            handData.handNumber = trimmedLine.split(" - ")[0].trim();
            handData.date = trimmedLine.split(" - ")[1].trim();
        } else if (trimmedLine.startsWith("Game:")) {
            handData.gameType = trimmedLine.split(":")[1].trim();
        } else if (trimmedLine.startsWith("Site:")) {
            handData.site = trimmedLine.split(":")[1].trim();
        } else if (trimmedLine.startsWith("Table:")) {
            handData.tableName = trimmedLine.split(":")[1].trim();
        } else if (trimmedLine.startsWith("Seat")) {
            const seatData = trimmedLine.split(":");
            const seatNumber = seatData[0].trim();
            const playerData = seatData[1].trim();
            handData.players = handData.players || [];
            handData.players.push({ seat: seatNumber, player: playerData });
        } else if (trimmedLine.startsWith("** Flop **") || trimmedLine.startsWith("** Turn **") || trimmedLine.startsWith("** River **")) {
            handData.board = trimmedLine.replace("**", "").replace("**", "").trim();
        } else if (trimmedLine.startsWith("** Summary **")) {
            currentSection = "summary";
        } else if (currentSection === "summary") {
            // Process the summary here as needed
        }
    });

    console.log("Parsed Hand Data: ", handData);
    return handData;
}


        function generateXML(data) {
            let xml = `<?xml version="1.0" encoding="utf-8" ?>\n<hand number="${data.handNumber}" date="${data.date}">\n`;

            // Game Information
            xml += `<game>${data.game}</game>\n`;
            xml += `<site>${data.site}</site>\n`;
            xml += `<table>${data.table}</table>\n`;

            // Players
            xml += `<players>\n`;
            data.players.forEach(player => {
                xml += `<player seat="${player.seat}" chips="${player.chips}" />\n`;
            });
            xml += `</players>\n`;

            // Actions
            xml += `<actions>\n`;
            data.actions.forEach(action => {
                xml += `<action>${action}</action>\n`;
            });
            xml += `</actions>\n`;

            xml += `</hand>`;

            return xml;
        }
    </script>
</body>
</html>
